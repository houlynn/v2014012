/**
 * 导航区域的主控界面,这是这个系统的核心控件之一
 * moduleName:PropertyCompany
cascading:true
isContainNullRecord:false
title:省份-市-客户单位
navigatePath:Province--City--Customer
reverseOrder:false
mode:null
type:
parentFilter:null
node:root
[{"expanded":true,"tooltip":null,"fieldname":null,"text":"客户单位","fieldvalue":null,"isCodeLevel":null,"equalsMethod":null,"parentId":null,"moduleName":"Customer","count":39,"children":[{"expanded":true,"tooltip":null,"fieldname":"tf_customerId","text":"无锡市太乙公司","fieldvalue":"1","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Customer","count":13,"children":[{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2014-04-00001","fieldvalue":"1","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":5,"children":[],"nativeValue":"1","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2013-05-00001","fieldvalue":"8","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":3,"children":[],"nativeValue":"8","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2014-05-0012","fieldvalue":"11","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":2,"children":[],"nativeValue":"11","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2014-06-0008","fieldvalue":"12","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":1,"children":[],"nativeValue":"12","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"1","fieldvalue":"13","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":2,"children":[],"nativeValue":"13","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"}],"nativeValue":"1","tag":-1,"tableAsName":"_t6010","fieldtitle":"客户单位","leaf":false,"icon":"images/module/Customer.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_customerId","text":"无锡市太湖汽车制造公司","fieldvalue":"3","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Customer","count":3,"children":[{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2013-08-00001","fieldvalue":"10","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":3,"children":[],"nativeValue":"10","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"}],"nativeValue":"3","tag":-1,"tableAsName":"_t6010","fieldtitle":"客户单位","leaf":false,"icon":"images/module/Customer.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_customerId","text":"苏州市虎丘贸易公司","fieldvalue":"5","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Customer","count":5,"children":[{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2014-04-00002","fieldvalue":"2","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":5,"children":[],"nativeValue":"2","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"}],"nativeValue":"5","tag":-1,"tableAsName":"_t6010","fieldtitle":"客户单位","leaf":false,"icon":"images/module/Customer.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_customerId","text":"承德市避暑山庄有限公司","fieldvalue":"9","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Customer","count":12,"children":[{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2014-04-00003","fieldvalue":"3","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":1,"children":[],"nativeValue":"3","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2014-04-00005","fieldvalue":"5","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":3,"children":[],"nativeValue":"5","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2014-04-00006","fieldvalue":"6","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":4,"children":[],"nativeValue":"6","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2013-05-00002","fieldvalue":"9","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":4,"children":[],"nativeValue":"9","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"}],"nativeValue":"9","tag":-1,"tableAsName":"_t6010","fieldtitle":"客户单位","leaf":false,"icon":"images/module/Customer.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_customerId","text":"承德市三保制造有限公司","fieldvalue":"10","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Customer","count":6,"children":[{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2014-04-00004","fieldvalue":"4","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":2,"children":[],"nativeValue":"4","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"},{"expanded":true,"tooltip":null,"fieldname":"tf_ordersId","text":"2014-04-00007","fieldvalue":"7","isCodeLevel":false,"equalsMethod":null,"parentId":null,"moduleName":"Orders","count":4,"children":[],"nativeValue":"7","tag":-1,"tableAsName":"_t6040","fieldtitle":"订单","leaf":true,"icon":"images/module/Orders.png"}],"nativeValue":"10","tag":-1,"tableAsName":"_t6010","fieldtitle":"客户单位","leaf":false,"icon":"images/module/Customer.png"}],"nativeValue":null,"tag":-1,"tableAsName":"_t6010","fieldtitle":null,"leaf":false,"icon":null}]
 
 moduleName:Customer
schemeOrder:1
columns:P__t7010___tf_name,_t7012___tf_name,_t7016___tf_name,_t7014___tf_name,tf_name,tf_address,tf_linkman,tf_linkmanTel,tf_taxId,tf_remark,C_Orders,S__t6050___tf_subtotalPrice,S__t6060___tf_imcomePrice
navigates:[{"moduleName":"City","tableAsName":"_t7012","primarykey":"tf_cityId","fieldtitle":"\u5e02","equalsValue":"0301","equalsMethod":null,"text":"\u77f3\u5bb6\u5e84\u5e02","isCodeLevel":false}]
 
 
 
 *
 *
 */

Ext.define('core.app.view.region.Navigate', {
	   extend: "Ext.panel.Panel",
		style:'border-width:0 0 0 0;',
       alias: "widget.modulenavigate",
       requires: ["core.app.view.region.NavigateTree"],
       layout: "fit",
       config: {
               tabPosition: "left",
               navigateMode: "tab",
               allSelected: !1,
               module: null,
               parentFilter: null
       },
       header: {
               tag: "modulenavigate"
       },
       tools: [{
               type: "refresh",
               tooltip: "\u5237\u65b0\u6240\u6709\u5bfc\u822a\u8bb0\u5f55"
       },
       {
               type: "plus",
               tooltip: "\u6240\u6709\u9009\u4e2d\u7684\u5bfc\u822a\u6761\u4ef6\u90fd\u6709\u6548"
       },
       {
               type: "minus",
               hidden: !0,
               tooltip: "\u4ec5\u5f53\u524d\u9009\u4e2d\u7684\u5bfc\u822a\u6761\u4ef6\u6709\u6548"
       },
       {
               type: "pin",
               tooltip: "\u4ee5Tab\u5f62\u5f0f\u663e\u793a\u5404\u5bfc\u822a\u6811",
               hidden: !0
       },
       {
               type: "unpin",
               tooltip: "\u4ee5\u5c42\u53e0\u5f62\u5f0f\u663e\u793a\u5404\u5bfc\u822a\u6811"
       },
       {
               type: "gear",
               tooltip: "\u66f4\u591a\u504f\u597d\u8bbe\u7f6e"
       }],
       initComponent: function() {
               this.items = [],
               this.navigateValues = new Ext.util.MixedCollection,
               this.setSelectedNavigates(this.defaultNavigateValues),
               this.listeners = {
                       render: function() {
                               this.initNavigateInTab()
                       }
               },
               this.callParent(arguments)
       },
       setSelectedNavigates: function(e) {
               var t = this;
               e && e.length > 0 && (t.navigateValues.clear(), Ext.each(e,
               function(e) {
                       for (var i in e) t.navigateValues.add(i, e[i])
               }))
       },
       getSettingMenu: function() {
                return this.settingMenu || (this.settingMenu = Ext.create("core.app.view.region.SettingMenu", {
                        navigate: this
                })),
                this.settingMenu
        },
       
       
       
       
       applyNavigateMode: function(e) {
               this.navigateMode = e;
               var t;
               t = "tab" == this.navigateMode ? new Ext.widget("tabpanel", {
                       tabPosition: this.tabPosition,
                       plugins: [Ext.create("Ext.ux.TabReorderer")]
               }) : new Ext.widget("panel", {
                       layout: {
                               type: "accordion",
                               animate: !0,
                               multi: this.module.tf_moduleGridNavigates.length < 4
                       }
               });
               for (var i in this.module.tf_moduleGridNavigates) {
                       var o = this.module.tf_moduleGridNavigates[i];
                       t.add({
                               title: o.tf_text,
                               layout: "fit",
                               items: [this.down("navigatetree#" + o.tf_fields)]
                       })
               }
               this.removeAll(!0),
               this.add(t)
       },
       initNavigateInTab: function() {
    	   console.log("======initNavigateInTab=====module===================")
    	   console.log(this.module)
               var e = new Ext.widget("tabpanel", {
                       tabPosition: this.tabPosition,
                       plugins: [Ext.create("Ext.ux.TabReorderer")]
               });
               for (var t in this.module.tf_moduleGridNavigates) {
                       var i = this.module.tf_moduleGridNavigates[t];
                       e.add({
                               title: i.tf_text,
                               datapanel: !0,
                               layout: "fit",
                               items: [{
                                       xtype: "navigatetree",
                                       border: !0,
                                       itemId: i.tf_fields,
                                       navigatetitle: i.tf_text,
                                       path: i.tf_fields,
                                       cascading: i.tf_cascading,
                                       mode: Ext.encode(i.tf_NumberGroup),
                                       type: i.tf_type,
                                       reverseOrder: i.tf_reverseOrder,
                                       module: this.module,
                                       parentFilter: this.parentFilter
                               }]
                       })
               }
               console.log("==========initNavigateInTab this===============")
                console.log(this);
               this.add(e);
               
       },
       clearNavigateValues: function() {
               this.navigateValues.clear(),
               this.refreshGridStore()
       },
       addNavigateValue: function(e, t) {
               this.allSelected ? (this.navigateValues.removeAtKey(e), t && this.navigateValues.add(e, t)) : (this.navigateValues.clear(), t && this.navigateValues.add(e, t)),
               this.refreshGridStore()
       },
       applyParentFilter: function(e) {
               this.navigateValues.clear(),
               this.parentFilter = e,
               Ext.each(this.query("navigatetree"),
               function(t) {
                       t.setParentFilter(e)
               })
       },
       changeParentFilter: function(e) {
               this.navigateValues.clear(),
               this.parentFilter = e,
               Ext.each(this.query("navigatetree"),
               function(t) {
                       t.setParentFilter(e)
               })
       },
       refreshNavigateTree: function() {
               Ext.each(this.query("navigatetree"),
               function(e) {
                       e.store.reload()
               })
       },
       refreshGridStore: function() {
               var e = [];
               this.navigateValues.each(function(t) {
                       e.push(t)
               }),
               this.up("modulepanel").down("modulegrid").store.applyNavigates(e),
               this.up("modulepanel").down("modulegrid").updateTitle()
       }
});